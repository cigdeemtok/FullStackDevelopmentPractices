<%- include("partials/header.ejs") %>

<div class="container my-5 flex-grow-1">
    <% if(locals.editError){ %>
  <div class="alert alert-danger" role="alert">
    Error getting the to be edited post! Please try again. Error : <%= editError %>
  </div>
  <% } %>
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
        <div class="p-4 text-white text-center" style="background-color: #1b3022;">
          <h2 class="fw-bold mb-0">
            <%= locals.book ? 'Edit Book Review' : 'Create New Review' %>
          </h2>
        </div>
        
        <div class="card-body p-5 bg-white">
          <form action="<%= locals.book ? '/editBook/' + book.id : '/addBook' %>" method="POST">
            
            <div class="row">
              <div class="col-md-6 mb-4">
                <label class="form-label fw-bold text-muted small uppercase">Book Title</label>
                <input type="text" name="title" class="form-control custom-input" 
                       value="<%= locals.book ? book.title : '' %>" required placeholder="e.g. 1984">
              </div>
              
              <div class="col-md-6 mb-4">
                <label class="form-label fw-bold text-muted small uppercase">Author</label>
                <input type="text" name="author" class="form-control custom-input" 
                       value="<%= locals.book ? book.author : '' %>" required placeholder="George Orwell">
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-4">
                <label class="form-label fw-bold text-muted small uppercase">ISBN Number</label>
                <input type="text" name="isbn" class="form-control custom-input" 
                       value="<%= locals.book ? book.isbn : '' %>" required placeholder="9780451524935">
              </div>
              
              <div class="col-md-6 mb-4">
                <label class="form-label fw-bold text-muted small uppercase">Rating (1-5)</label>
                <select name="rating" class="form-select custom-input">
                  <% for(let i=5; i>=1; i--) { %>
                    <option value="<%= i %>" <%= locals.book && book.rating == i ? 'selected' : '' %> required>
                      <%= i %> Stars
                    </option>
                  <% } %>
                </select>
              </div>
            </div>
            <div class="col-md-6 mb-4">
  <label class="form-label fw-bold text-muted small uppercase">Date Read</label>
  <input type="date" name="date_read" class="form-control custom-input" 
         value="<%= locals.book && book.date_read ? new Date(book.date_read).toISOString().split('T')[0] : new Date().toISOString().split('T')[0] %>" 
         required>
</div>
            <div class="mb-4">
              <label class="form-label fw-bold text-muted small uppercase">About the Book</label>
              <textarea name="description" class="form-control custom-input" rows="4" required><%= locals.book ? book.description : '' %></textarea>
            </div>

            <div class="mb-5">
              <label class="form-label fw-bold text-muted small uppercase">My Personal Notes</label>
              <textarea name="notes" class="form-control custom-input" rows="3" required placeholder="What did you think about it?"><%= locals.book ? book.notes : '' %></textarea>
            </div>

            <div class="d-flex gap-3 justify-content-end border-top pt-4">
              <a href="/" class="btn btn-link text-decoration-none text-muted">Cancel</a>
              <button type="submit" class="btn-forest px-5">
                <i class="bi bi-check-circle me-2"></i><%= locals.book ? 'Edit Review' : 'Create Review' %>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include("partials/footer.ejs") %>